<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> 내, 외부망 통신 서버 구축 | JooHyoung Cha </title> <meta name="author" content="JooHyoung Cha"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://blog.udon.party/blog/2022/dual-lan/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">JooHyoung</span> Cha </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">내, 외부망 통신 서버 구축</h1> <p class="post-meta"> Created in January 10, 2022 by piorosen </p> <p class="post-tags"> <a href="/blog/2022"> <i class="fa-solid fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/tag/network"> <i class="fa-solid fa-hashtag fa-sm"></i> network</a>   <a href="/blog/tag/internal"> <i class="fa-solid fa-hashtag fa-sm"></i> internal</a>   <a href="/blog/tag/external"> <i class="fa-solid fa-hashtag fa-sm"></i> external</a>   <a href="/blog/tag/ftp"> <i class="fa-solid fa-hashtag fa-sm"></i> ftp</a>   <a href="/blog/tag/gateway"> <i class="fa-solid fa-hashtag fa-sm"></i> gateway</a>   <a href="/blog/tag/dual-lan"> <i class="fa-solid fa-hashtag fa-sm"></i> dual-lan</a>   <a href="/blog/tag/nat"> <i class="fa-solid fa-hashtag fa-sm"></i> nat</a>   <a href="/blog/tag/dhcp"> <i class="fa-solid fa-hashtag fa-sm"></i> dhcp</a>   <a href="/blog/tag/hub"> <i class="fa-solid fa-hashtag fa-sm"></i> hub</a>   <a href="/blog/tag/netplan"> <i class="fa-solid fa-hashtag fa-sm"></i> netplan</a>   ·   <a href="/blog/category/blogging"> <i class="fa-solid fa-tag fa-sm"></i> Blogging</a>   <a href="/blog/category/cloud"> <i class="fa-solid fa-tag fa-sm"></i> Cloud</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h1 id="개요">개요</h1> <p>학교 서버 컴퓨터가 사용하고 있는 L2 스위치 허브가 저렴한 제품을 사용하고 있기 때문에 최대 속도가 100mbps 밖에 나오지 않는 상황이였다. 그렇다 보니, k8s를 이용해서 컴퓨터를 클러스터링 하고, 공유 폴더를 NFS 활용하여 다른 Node가 같이 동시에 동작하더라도 NFS의 공유 폴더를 통하여 데이터의 통일성, 무결성을 유지하였다. 하지만 NFS는 네트워크 드라이브 이기 때문에 절대적인 네트워크 속도가 중요했다. 그래서 네트워크 속도를 올리기 위해선 스위치 허브를 교체하거나, 새로운 인터넷 망을 구축해야 했다.</p> <h1 id="제품-선택">제품 선택</h1> <p>처음에는 스위치 허브를 구매해서 10gbps나, 1gbps를 이용하려고 하였지만, 네트워크 드라이브인 NFS나 iSCSI의 경우는 사설망 만들어주는 NAT 프로토콜과 IP 할당 프로토콜인 DHCP가 있는 제품을 이용해야 했다. 그래서 필연적으로 NAT와 DHCP를 지원하는 L3 스위치 허브를 살것인가, 공유기를 구매할 것인가? 로 나눠지게 되었고 비교적 저렴한 공유기를 구매하였다.</p> <h1 id="망-분리">망 분리</h1> <p>공유기를 구매 하면서 100mbps의 속도를 가진 스위치 허브와, 1gbps 속도를 가진 공유기가 있었다. 그리고 우연찮게 k8s로 묶인 모든 Node가 랜 포트가 2개가 있었기 때문에 외부망은 100mbps로 하고, 내부망 끼리는 공유기를 이용해서 연결 하였다. 망분리된 사진은 아래와 같다.</p> <p><img src="/assets/img/post/2022-01-11-server.JPG" alt="사진"></p> <h1 id="네트워크-설정">네트워크 설정</h1> <p>네트워크 설정은 외부망과 내부망 연결을 동시에 해야하는 경우에는 서브넷 마스크와 게이트웨이를 적절히 사용해야 한다. 우분투의 경우에는 IP 주소와 서브넷 마스크를 함께 적는 CIDR 형식으로 작성 해야한다. CIDR은 아이피주소/서브넷마스크 형식으로 작성한다. 그래서 eno1은 외부망, enp4s0f2의 경우는 내부망으로 연결을 하였다. 외, 내부망분리를 할 때는 외부망은 게이트웨이 입력 함으로써, 서브넷 마스크외의 데이터는 게이트웨이로 데이터가 보내지도록 만들고, 내부망은 외부망과 연결이 되어 있지 않으므로, 게이트웨이를 입력하지 않고, CIDR형식으로 아이피와 서브넷 마스크를 설정 하였다.</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># This is the network config written by 'subiquity'</span>
<span class="na">network</span><span class="pi">:</span>
  <span class="na">ethernets</span><span class="pi">:</span>
    <span class="na">eno1</span><span class="pi">:</span>
      <span class="na">addresses</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">XXX.XXX.XXX.XXX/24</span>
      <span class="na">gateway4</span><span class="pi">:</span> <span class="s">113.198.230.254</span>
      <span class="na">nameservers</span><span class="pi">:</span>
        <span class="na">addresses</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">Y.Y.Y.Y</span>
        <span class="pi">-</span> <span class="s">Z.Z.Z.Z</span>
        <span class="na">search</span><span class="pi">:</span> <span class="pi">[]</span>
    <span class="na">enp4s0f2</span><span class="pi">:</span>
      <span class="na">addresses</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">192.168.0.10/24</span>
      <span class="na">nameservers</span><span class="pi">:</span>
        <span class="na">addresses</span><span class="pi">:</span> <span class="pi">[]</span>
        <span class="na">search</span><span class="pi">:</span> <span class="pi">[]</span>
  <span class="na">version</span><span class="pi">:</span> <span class="m">2</span>
</code></pre></div></div> <p>우분투에서 네트워크 설정은 netplan을 통해서 설정을 하였고, 해당 yml은 netplan에 적용한 코드이다.</p> <p><img src="/assets/img/post/2022-01-11-serverip.png" alt="사진"></p> <p>서버 아이피를 할당한 예시와 시놀로지 나스에 적용한 결과물이다.</p> <p><img src="/assets/img/post/2022-01-11-nas.png" alt="사진"></p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Winograd-Algorithm/">위노그라드 알고리즘 정리</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/ssh-vpn-forward/">외부에서 내부망으로 접근하기 위한 3가지의 방법론</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/GIST-Developer/">GIST Developers' Night 2024에 연사로 참가하고 나서</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/jvm-book-readed/">JVM 밑바닥까지 파헤치기 책을 읽고</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/reading-High-Performance-Cpp/">고성능을 위한 언어 C++ 책을 읽고나서</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 JooHyoung Cha. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>